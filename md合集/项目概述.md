# 项目总览（一句话）

## 《基于 MITM 与 Frida 的移动应用数据抓取与动态分析平台》

用 mitmproxy 做流量代理 + Flask 保存与展示会话 → 前端可视化会话、敏感字段高亮 → 一键生成 Frida hook 脚本（模板化）并下载/运行，从抓包到动态 Hook 完成端到端演示。

## 1. 项目背景

随着移动应用和在线考试等场景的普及，应用流量分析与安全监测的需求越来越突出。传统抓包工具（如 Charles、Wireshark、BurpSuite）虽能捕获流量，但缺乏一体化的可视化分析、实时监控和脚本注入扩展能力。
 本项目旨在开发一个 **集成式流量分析与注入平台**，实现从流量捕获、后端存储、前端展示到动态脚本注入的完整链路。

------

## 2. 系统架构

系统采用 **三层架构**：

1. **流量捕获层（mitmproxy 插件）**

   - 设备/应用的流量通过代理进入 mitmproxy。
   - 插件拦截请求/响应，提取关键信息（URL、Headers、Body、时间）。
   - 进行敏感信息检测（如手机号、邮箱、Base64 特征）。
   - 将数据通过 HTTP POST 上报到后端 Flask。

2. **数据处理层（Flask + SQLite + Socket.IO）**

   - **Flask API**：提供会话接收、查询、清理等接口。
   - **SQLite**：存储所有流量会话，支持持久化与搜索。
   - **Socket.IO**：实现与前端的实时通信，将新会话、Frida 日志等推送给用户。
   - **Frida/Probe 接口**：支持生成、运行脚本，并实时回传执行结果。

3. **展示与控制层（前端界面 index.html）**

   - **会话展示**：实时显示 mitmproxy 捕获的请求详情。
   - **搜索与过滤**：支持关键字搜索与敏感标记过滤。
   - **控制台输出**：实时查看 Frida 脚本执行日志。
   - **Frida 集成**：可在线生成脚本、注入目标进程、运行自定义 Probe。

   1. **手机（被测端）**
      - 通过 Wi-Fi 把 HTTP/HTTPS 流量走电脑代理（mitmproxy），需要安装 mitmproxy 证书以解密 HTTPS。
   2. **代理层（mitmproxy）**
      - mitmproxy addon：拦截请求/响应，做可疑字段检测（规则 + 简单 entropy），将会话以 POST 形式发送到后端（Flask）。
   3. **后端（Flask / SQLite）**
      - 接收会话、存储（SQLite），进行更复杂的检测（可选 ML/规则），提供 REST API 给前端和“生成 Frida”逻辑。
   4. **前端（单页，Electron 可选）**
      - 列表会话、会话详情（headers/body）、高亮 suspicious 字段、按钮“一键生成 Frida 脚本”与“下载脚本”/“复制脚本”。
   5. **Frida 助手（脚本生成器）**
      - 根据会话信息（URL、字段名、base64/hex 检测）自动生成一个 frida js 模板（注入 OKHttp、RequestBody 或特定 Java 方法），用户下载后用 frida 注入到目标进程，实时看到中间值。
   6. **演示流程**
      - 手机 → 代理（mitmproxy） → Flask 存会话 → 前端展示 → 生成 Frida → 注入观察中间变量。

------

## 3. 系统功能概述

- **流量捕获与上报**
  - 基于 mitmproxy 插件，将捕获的流量自动上报后端。
- **会话存储与管理**
  - 所有会话存入 SQLite，支持查询、导出、清理。
- **实时推送与展示**
  - 通过 Socket.IO 实时通知前端，用户无需刷新即可看到新数据。
- **Frida 动态注入**
  - 生成/注入 JS 脚本到移动应用进程，实时输出 hook 日志。
- **Probe 功能**
  - 提供目标进程/类的探测能力，辅助逆向与安全研究。
- **安全控制**
  - 关键接口需 `ADMIN_TOKEN` 才能调用，避免恶意滥用。

------

## 4. 当前进展

- ✅ **mitmproxy 插件**：实现了流量捕获、队列上报、错误重试机制。
- ✅ **Flask 后端**：完成 API、SQLite 存储、Socket.IO 实时推送、Frida 注入接口。
- ✅ **前端界面**：能展示会话详情、执行搜索、生成/注入 Frida 脚本，并实时接收日志。
- ✅ **整体闭环**：mitmproxy → Flask → SQLite → Socket.IO → 前端，链路已打通。